Initialized Project: 

curtis@NetApp-MacBook-Pro gateway % operator-sdk init --domain netapp.com --repo github.com/NetApp-Learning-Services/gateway

Created API and Controller:

curtis@NetApp-MacBook-Pro gateway % operator-sdk create api --group gateway --version v1alpha1 --kind StorageVirtualMachine --resource --controller

Updated storagevirtualmachine_types.go

Execute to update zz_generated.deepcopy.go:  make generate 

Execute to create the CRDs:  make manifests

Wrote reconcile method

Make the file:  make build

Install operator-sdk on kubwor2-1: 

export ARCH=$(case $(uname -m) in x86_64) echo -n amd64 ;; aarch64) echo -n arm64 ;; *) echo -n $(uname -m) ;; esac)
export OS=$(uname | awk '{print tolower($0)}')
export OPERATOR_SDK_DL_URL=https://github.com/operator-framework/operator-sdk/releases/download/v1.23.0
curl -LO ${OPERATOR_SDK_DL_URL}/operator-sdk_${OS}_${ARCH}
chmod +x operator-sdk_${OS}_${ARCH} && sudo mv operator-sdk_${OS}_${ARCH} /usr/local/bin/operator-sdk

Install go on kubwor2-1:

rm -rf /usr/local/go && tar -C /usr/local -xzf go1.19.2.linux-amd64.tar.gz
export PATH=$PATH:/usr/local/go/bin
wget https://dl.google.com/go/go1.19.2.linux-amd64.tar.gz
sudo tar -C /usr/local/ -xzf go1.19.2.linux-amd64.tar.gz

Copy to kubwor2-1:  git clone https://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@github.com/NetApp-Learning-Services/gateway/

setup kubectl config on kubwor2-1

install the CRD on kubwor2-1:  kubectl create -f config/crd/bases/gateway.netapp.com_storagevirtualmachines.yaml

To update source on kubwor2-1:  git pull origin (instead gateway directory)

To build in docker:  make docker-build IMG=docker-registry:30001/astra/gateway:v0.1
To list docker images:  docker images
To delete docker image:  docker image rm [image_id]
To login to private registry:  docker login -u admin -p Netapp1! https://docker-registry:30001
To push to private registry:  docker push docker-registry:30001/astra/gateway:v0.1
To view private registry: curl -ik --user admin:Netapp1! https://docker-registry:30001/v2/_catalog
A quick way to build and push:  make docker-build docker-push IMG=docker-registry:30001/astra/gateway:v0.1

To build in go: go main.go

To override existing files in git and pull again:
git fetch --all
git reset --hard origin/master

To run local on a particular worker node:
install operator-sdk
git clone
git pull origin
build docker image
push docker image to private registry
within cloned directory, make deploy

To deploy operator create the following:
namespace/gateway-system 
customresourcedefinition.apiextensions.k8s.io/storagevirtualmachines.gateway.netapp.com 
serviceaccount/gateway-controller-manager  
role.rbac.authorization.k8s.io/gateway-leader-election-role  
clusterrole.rbac.authorization.k8s.io/gateway-manager-role  
clusterrole.rbac.authorization.k8s.io/gateway-metrics-reader  
clusterrole.rbac.authorization.k8s.io/gateway-proxy-role  
rolebinding.rbac.authorization.k8s.io/gateway-leader-election-rolebinding  
clusterrolebinding.rbac.authorization.k8s.io/gateway-manager-rolebinding  
clusterrolebinding.rbac.authorization.k8s.io/gateway-proxy-rolebinding  
configmap/gateway-manager-config  
service/gateway-controller-manager-metrics-service  
deployment.apps/gateway-controller-manager  

Also need imagePullSecret:
kubectl create secret docker-registry reg-cred-secret --namespace gateway-system --docker-server="docker-registry:30001" --docker-username=admin --docker-password=Netapp1! --dry-run=client -o yaml
kubectl create secret docker-registry reg-cred-secret --namespace gateway-system --docker-server="docker-registry:30001" --docker-username=admin --docker-password=Netapp1! 

To create a test CR:
kubectl -n gateway-system create -f notes/testCR.yaml

Wrote bash script test.sh to reset and test the application:
bash test.sh
